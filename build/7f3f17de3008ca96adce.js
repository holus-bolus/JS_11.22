function app(){let e=document.forms[0],t=!1,a="",s=0,n=0,r="",l=[],c="",i=0,d=/[\/\*\-\+]/,h=h=>{let k=h.target||h,m=f(h.keyCode,h.shiftKey,h.altKey,h.metaKey),p=e.output;if(13===h.keyCode?h.preventDefault():m||h.keyCode||(m=k.getAttribute("data-fn")),m&&p){let e=+p.maxLength,h=10**e,f=!isNaN(m),k="."===m,y="%"===m,v="sqrt"===m,x="+-"===m,S="mrc"===m,C="m-"===m,L="m+"===m,_="/*-+".indexOf(m)>-1,q="="===m,M="C"===m;if(!a){if(l.length&&(c=l[l.length-1]),(f||k||y||v||x||_)&&(t||(t=!0,(f||k)&&(r="",l=["0"],c=l[0],i=0)),l.length||l.push("0")),f){if(isNaN(c))l.push(m);else if(c.length<e){let e=c+m;"0"===e[0]&&"."!==e[1]&&(e=e.substr(1)),l[l.length-1]=e}}else if(k)-1===c.indexOf(".")&&(isNaN(c)?l.push("0."):c.length<e-1&&(l[l.length-1]+=m));else if(y)l.length&&(isNaN(c)?(l.push(""+l[0]*(l[0]/100)),l[l.length-1]=b(l[l.length-1])):r&&l.indexOf(r)>-1?l[l.length-1]=b(l[0]*l[l.length-1]/100):(l[l.length-1]=b(l[l.length-1]/100),t=!1)),g();else if(v)l.length&&(isNaN(c)?l.push(String(Math.sqrt(l[0]))):l[l.length-1]=String(Math.sqrt(l[l.length-1]))),g();else if(x)l.length&&(isNaN(c)?l[0]=String(-l[0]):l[l.length-1]=String(-l[l.length-1]));else if(S)0!==n&&n===s?l.length<=1&&(t=!1,n=0,u(!1)):(t||(t=!0),isNaN(c)||!l.length?l.push(String(n)):l[l.length-1]=String(n),c=l[l.length-1],i=c,u(0!==n));else if(_){if(r=m,isNaN(c))l[l.length-1]=r;else{let e=l.join(" ");d.test(e)&&(l=[`${N(l[0],l[1],l[2])}`],l[0]=b(l[0]),c=l[0],s=c),l.push(r)}g()}else{let e=C||L;if(q||e){t=!1,r&&l.indexOf(r)>-1&&(i=c);let a=i&&-1===l.indexOf(r),d=!isNaN(i);a?e||(l=[`${N(s,r,i)}`]):d?l=[`${N(l[0],r,i)}`]:(i=l[0],l=[`${N(s,r,s)}`]),l[0]=b(l[0]),e&&(C&&(n-=+l[0]),L&&(n+=+l[0]),u(0!==n)),g()}}if("C"!==m){if(c=l[l.length-1],isNaN(c)&&"NaN"!==c||(s=c),Math.abs(s)===1/0||"NaN"===s)a="0";else if(s<=-h/10){let t=e-3;t<0&&(t=0),a=(s/h).toFixed(t)}else if(s>=h){let t=e-2;t<0&&(t=0),a=(s/h).toFixed(t)}let t=a||String(s);a?o():t=s>=-1e8&&s<-1e7||s>=1e8&&s<1e9?t.substr(0,e-1):t.substr(0,e),p.value=t}}M&&(t=!1,a="",s=0,(Math.abs(n)===1/0||isNaN(n))&&(n=0,u(!1)),r="",l=[],c="",i=0,p.value=s,g(),o(!1))}},g=()=>{let t=e.output;if(t){let e="calc__screen--fade-in",a=t.classList;a.remove(e),t.offsetWidth,setTimeout((()=>{a.add(e)}),0)}},o=(t=!0)=>{e.querySelector(".calc__error").textContent=t?"E":""},u=(t=!0)=>{e.querySelector(".calc__memory").textContent=t?"M":""},f=(e,t,a,s)=>{let n="";switch(e){case 12:case 27:case 67:s||(n="C");break;case 13:n="=";break;case 48:case 96:n="0";break;case 49:case 97:n="1";break;case 50:case 98:n="2";break;case 51:case 99:n="3";break;case 52:case 100:n="4";break;case 53:case 101:n=t?"%":"5";break;case 54:case 102:n="6";break;case 55:case 103:n="7";break;case 56:n=t?"*":"8";break;case 104:n="8";break;case 57:case 105:n="9";break;case 77:n="mrc";break;case 83:n="sqrt";break;case 106:n="*";break;case 107:n="+";break;case 187:n=t?"+":"=";break;case 188:n=t?"m-":"";break;case 109:case 189:n=a?"+-":"-";break;case 110:n=".";break;case 190:n=t?"m+":".";break;case 111:case 191:n="/";break;default:n=""}return n},k=(t,a="down")=>{t.target;let s=f(t.keyCode,t.shiftKey,t.altKey,t.metaKey),n=e.querySelector(`[data-fn="${s}"]`);if(n){let e="calc__btn--active",t=n.classList;"down"!==a||t.contains(e)?"up"===a&&t.contains(e)&&t.remove(e):t.add(e)}},b=(e,t=9)=>{let a=10**-t,s=Math.round(e/a)*a;return String(+s.toFixed(t))},N=(e,t,a)=>{let s=0,n=isNaN(e)?s:+e,r=isNaN(a)?n:+a;switch(t){case"/":s=n/r;break;case"*":s=n*r;break;case"-":s=n-r;break;case"+":s=n+r;break;default:s=n}return s};e.addEventListener("click",h),document.addEventListener("keydown",h),document.addEventListener("keydown",k),document.addEventListener("keyup",(e=>k(e,"up")))}document.addEventListener("DOMContentLoaded",app);